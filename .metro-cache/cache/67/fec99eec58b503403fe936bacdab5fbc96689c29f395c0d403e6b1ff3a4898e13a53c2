{"dependencies":[{"name":"../../utils/factory.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"7GBwrsWWKVeatBp94Er80/CdjPI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"createSpaClass\", {\n    enumerable: true,\n    get: function () {\n      return createSpaClass;\n    }\n  });\n  var _utilsFactoryJs = require(_dependencyMap[0], \"../../utils/factory.js\");\n  var name = 'Spa';\n  var dependencies = ['addScalar', 'equalScalar', 'FibonacciHeap'];\n  var createSpaClass = /* #__PURE__ */(0, _utilsFactoryJs.factory)(name, dependencies, _ref => {\n    var addScalar = _ref.addScalar,\n      equalScalar = _ref.equalScalar,\n      FibonacciHeap = _ref.FibonacciHeap;\n    /**\n     * An ordered Sparse Accumulator is a representation for a sparse vector that includes a dense array\n     * of the vector elements and an ordered list of non-zero elements.\n     */\n    function Spa() {\n      if (!(this instanceof Spa)) {\n        throw new SyntaxError('Constructor must be called with the new operator');\n      }\n\n      // allocate vector, TODO use typed arrays\n      this._values = [];\n      this._heap = new FibonacciHeap();\n    }\n\n    /**\n     * Attach type information\n     */\n    Spa.prototype.type = 'Spa';\n    Spa.prototype.isSpa = true;\n\n    /**\n     * Set the value for index i.\n     *\n     * @param {number} i                       The index\n     * @param {number | BigNumber | Complex}   The value at index i\n     */\n    Spa.prototype.set = function (i, v) {\n      // check we have a value @ i\n      if (!this._values[i]) {\n        // insert in heap\n        var node = this._heap.insert(i, v);\n        // set the value @ i\n        this._values[i] = node;\n      } else {\n        // update the value @ i\n        this._values[i].value = v;\n      }\n    };\n    Spa.prototype.get = function (i) {\n      var node = this._values[i];\n      if (node) {\n        return node.value;\n      }\n      return 0;\n    };\n    Spa.prototype.accumulate = function (i, v) {\n      // node @ i\n      var node = this._values[i];\n      if (!node) {\n        // insert in heap\n        node = this._heap.insert(i, v);\n        // initialize value\n        this._values[i] = node;\n      } else {\n        // accumulate value\n        node.value = addScalar(node.value, v);\n      }\n    };\n    Spa.prototype.forEach = function (from, to, callback) {\n      // references\n      var heap = this._heap;\n      var values = this._values;\n      // nodes\n      var nodes = [];\n      // node with minimum key, save it\n      var node = heap.extractMinimum();\n      if (node) {\n        nodes.push(node);\n      }\n      // extract nodes from heap (ordered)\n      while (node && node.key <= to) {\n        // check it is in range\n        if (node.key >= from) {\n          // check value is not zero\n          if (!equalScalar(node.value, 0)) {\n            // invoke callback\n            callback(node.key, node.value, this);\n          }\n        }\n        // extract next node, save it\n        node = heap.extractMinimum();\n        if (node) {\n          nodes.push(node);\n        }\n      }\n      // reinsert all nodes in heap\n      for (var i = 0; i < nodes.length; i++) {\n        // current node\n        var n = nodes[i];\n        // insert node in heap\n        node = heap.insert(n.key, n.value);\n        // update values\n        values[node.key] = node;\n      }\n    };\n    Spa.prototype.swap = function (i, j) {\n      // node @ i and j\n      var nodei = this._values[i];\n      var nodej = this._values[j];\n      // check we need to insert indeces\n      if (!nodei && nodej) {\n        // insert in heap\n        nodei = this._heap.insert(i, nodej.value);\n        // remove from heap\n        this._heap.remove(nodej);\n        // set values\n        this._values[i] = nodei;\n        this._values[j] = undefined;\n      } else if (nodei && !nodej) {\n        // insert in heap\n        nodej = this._heap.insert(j, nodei.value);\n        // remove from heap\n        this._heap.remove(nodei);\n        // set values\n        this._values[j] = nodej;\n        this._values[i] = undefined;\n      } else if (nodei && nodej) {\n        // swap values\n        var v = nodei.value;\n        nodei.value = nodej.value;\n        nodej.value = v;\n      }\n    };\n    return Spa;\n  }, {\n    isClass: true\n  });\n});","lineCount":147,"map":[[7,2,4,0,"Object"],[7,8,4,0],[7,9,4,0,"defineProperty"],[7,23,4,0],[7,24,4,0,"exports"],[7,31,4,0],[8,4,4,0,"enumerable"],[8,14,4,0],[9,4,4,0,"get"],[9,7,4,0],[9,18,4,0,"get"],[9,19,4,0],[10,6,4,0],[10,13,4,0,"createSpaClass"],[10,27,4,0],[11,4,4,0],[12,2,4,0],[13,2,1,0],[13,6,1,0,"_utilsFactoryJs"],[13,21,1,0],[13,24,1,0,"require"],[13,31,1,0],[13,32,1,0,"_dependencyMap"],[13,46,1,0],[14,2,2,0],[14,6,2,4,"name"],[14,10,2,8],[14,13,2,11],[14,18,2,16],[15,2,3,0],[15,6,3,4,"dependencies"],[15,18,3,16],[15,21,3,19],[15,22,3,20],[15,33,3,31],[15,35,3,33],[15,48,3,46],[15,50,3,48],[15,65,3,63],[15,66,3,64],[16,2,4,7],[16,6,4,11,"createSpaClass"],[16,20,4,25],[16,23,4,28],[16,38,4,43],[16,42,4,43,"factory"],[16,57,4,50],[16,58,4,50,"factory"],[16,65,4,50],[16,67,4,51,"name"],[16,71,4,55],[16,73,4,57,"dependencies"],[16,85,4,69],[16,87,4,71,"_ref"],[16,91,4,75],[16,95,4,79],[17,4,5,2],[17,8,6,4,"addScalar"],[17,17,6,13],[17,20,9,6,"_ref"],[17,24,9,10],[17,25,6,4,"addScalar"],[17,34,6,13],[18,6,7,4,"equalScalar"],[18,17,7,15],[18,20,9,6,"_ref"],[18,24,9,10],[18,25,7,4,"equalScalar"],[18,36,7,15],[19,6,8,4,"FibonacciHeap"],[19,19,8,17],[19,22,9,6,"_ref"],[19,26,9,10],[19,27,8,4,"FibonacciHeap"],[19,40,8,17],[20,4,10,2],[21,0,11,0],[22,0,12,0],[23,0,13,0],[24,4,14,2],[24,13,14,11,"Spa"],[24,16,14,14,"Spa"],[24,17,14,14],[24,19,14,17],[25,6,15,4],[25,10,15,8],[25,12,15,10],[25,16,15,14],[25,28,15,26,"Spa"],[25,31,15,29],[25,32,15,30],[25,34,15,32],[26,8,16,6],[26,14,16,12],[26,18,16,16,"SyntaxError"],[26,29,16,27],[26,30,16,28],[26,80,16,78],[26,81,16,79],[27,6,17,4],[29,6,19,4],[30,6,20,4],[30,10,20,8],[30,11,20,9,"_values"],[30,18,20,16],[30,21,20,19],[30,23,20,21],[31,6,21,4],[31,10,21,8],[31,11,21,9,"_heap"],[31,16,21,14],[31,19,21,17],[31,23,21,21,"FibonacciHeap"],[31,36,21,34],[31,37,21,35],[31,38,21,36],[32,4,22,2],[34,4,24,2],[35,0,25,0],[36,0,26,0],[37,4,27,2,"Spa"],[37,7,27,5],[37,8,27,6,"prototype"],[37,17,27,15],[37,18,27,16,"type"],[37,22,27,20],[37,25,27,23],[37,30,27,28],[38,4,28,2,"Spa"],[38,7,28,5],[38,8,28,6,"prototype"],[38,17,28,15],[38,18,28,16,"isSpa"],[38,23,28,21],[38,26,28,24],[38,30,28,28],[40,4,30,2],[41,0,31,0],[42,0,32,0],[43,0,33,0],[44,0,34,0],[45,0,35,0],[46,4,36,2,"Spa"],[46,7,36,5],[46,8,36,6,"prototype"],[46,17,36,15],[46,18,36,16,"set"],[46,21,36,19],[46,24,36,22],[46,34,36,32,"i"],[46,35,36,33],[46,37,36,35,"v"],[46,38,36,36],[46,40,36,38],[47,6,37,4],[48,6,38,4],[48,10,38,8],[48,11,38,9],[48,15,38,13],[48,16,38,14,"_values"],[48,23,38,21],[48,24,38,22,"i"],[48,25,38,23],[48,26,38,24],[48,28,38,26],[49,8,39,6],[50,8,40,6],[50,12,40,10,"node"],[50,16,40,14],[50,19,40,17],[50,23,40,21],[50,24,40,22,"_heap"],[50,29,40,27],[50,30,40,28,"insert"],[50,36,40,34],[50,37,40,35,"i"],[50,38,40,36],[50,40,40,38,"v"],[50,41,40,39],[50,42,40,40],[51,8,41,6],[52,8,42,6],[52,12,42,10],[52,13,42,11,"_values"],[52,20,42,18],[52,21,42,19,"i"],[52,22,42,20],[52,23,42,21],[52,26,42,24,"node"],[52,30,42,28],[53,6,43,4],[53,7,43,5],[53,13,43,11],[54,8,44,6],[55,8,45,6],[55,12,45,10],[55,13,45,11,"_values"],[55,20,45,18],[55,21,45,19,"i"],[55,22,45,20],[55,23,45,21],[55,24,45,22,"value"],[55,29,45,27],[55,32,45,30,"v"],[55,33,45,31],[56,6,46,4],[57,4,47,2],[57,5,47,3],[58,4,48,2,"Spa"],[58,7,48,5],[58,8,48,6,"prototype"],[58,17,48,15],[58,18,48,16,"get"],[58,21,48,19],[58,24,48,22],[58,34,48,32,"i"],[58,35,48,33],[58,37,48,35],[59,6,49,4],[59,10,49,8,"node"],[59,14,49,12],[59,17,49,15],[59,21,49,19],[59,22,49,20,"_values"],[59,29,49,27],[59,30,49,28,"i"],[59,31,49,29],[59,32,49,30],[60,6,50,4],[60,10,50,8,"node"],[60,14,50,12],[60,16,50,14],[61,8,51,6],[61,15,51,13,"node"],[61,19,51,17],[61,20,51,18,"value"],[61,25,51,23],[62,6,52,4],[63,6,53,4],[63,13,53,11],[63,14,53,12],[64,4,54,2],[64,5,54,3],[65,4,55,2,"Spa"],[65,7,55,5],[65,8,55,6,"prototype"],[65,17,55,15],[65,18,55,16,"accumulate"],[65,28,55,26],[65,31,55,29],[65,41,55,39,"i"],[65,42,55,40],[65,44,55,42,"v"],[65,45,55,43],[65,47,55,45],[66,6,56,4],[67,6,57,4],[67,10,57,8,"node"],[67,14,57,12],[67,17,57,15],[67,21,57,19],[67,22,57,20,"_values"],[67,29,57,27],[67,30,57,28,"i"],[67,31,57,29],[67,32,57,30],[68,6,58,4],[68,10,58,8],[68,11,58,9,"node"],[68,15,58,13],[68,17,58,15],[69,8,59,6],[70,8,60,6,"node"],[70,12,60,10],[70,15,60,13],[70,19,60,17],[70,20,60,18,"_heap"],[70,25,60,23],[70,26,60,24,"insert"],[70,32,60,30],[70,33,60,31,"i"],[70,34,60,32],[70,36,60,34,"v"],[70,37,60,35],[70,38,60,36],[71,8,61,6],[72,8,62,6],[72,12,62,10],[72,13,62,11,"_values"],[72,20,62,18],[72,21,62,19,"i"],[72,22,62,20],[72,23,62,21],[72,26,62,24,"node"],[72,30,62,28],[73,6,63,4],[73,7,63,5],[73,13,63,11],[74,8,64,6],[75,8,65,6,"node"],[75,12,65,10],[75,13,65,11,"value"],[75,18,65,16],[75,21,65,19,"addScalar"],[75,30,65,28],[75,31,65,29,"node"],[75,35,65,33],[75,36,65,34,"value"],[75,41,65,39],[75,43,65,41,"v"],[75,44,65,42],[75,45,65,43],[76,6,66,4],[77,4,67,2],[77,5,67,3],[78,4,68,2,"Spa"],[78,7,68,5],[78,8,68,6,"prototype"],[78,17,68,15],[78,18,68,16,"forEach"],[78,25,68,23],[78,28,68,26],[78,38,68,36,"from"],[78,42,68,40],[78,44,68,42,"to"],[78,46,68,44],[78,48,68,46,"callback"],[78,56,68,54],[78,58,68,56],[79,6,69,4],[80,6,70,4],[80,10,70,8,"heap"],[80,14,70,12],[80,17,70,15],[80,21,70,19],[80,22,70,20,"_heap"],[80,27,70,25],[81,6,71,4],[81,10,71,8,"values"],[81,16,71,14],[81,19,71,17],[81,23,71,21],[81,24,71,22,"_values"],[81,31,71,29],[82,6,72,4],[83,6,73,4],[83,10,73,8,"nodes"],[83,15,73,13],[83,18,73,16],[83,20,73,18],[84,6,74,4],[85,6,75,4],[85,10,75,8,"node"],[85,14,75,12],[85,17,75,15,"heap"],[85,21,75,19],[85,22,75,20,"extractMinimum"],[85,36,75,34],[85,37,75,35],[85,38,75,36],[86,6,76,4],[86,10,76,8,"node"],[86,14,76,12],[86,16,76,14],[87,8,77,6,"nodes"],[87,13,77,11],[87,14,77,12,"push"],[87,18,77,16],[87,19,77,17,"node"],[87,23,77,21],[87,24,77,22],[88,6,78,4],[89,6,79,4],[90,6,80,4],[90,13,80,11,"node"],[90,17,80,15],[90,21,80,19,"node"],[90,25,80,23],[90,26,80,24,"key"],[90,29,80,27],[90,33,80,31,"to"],[90,35,80,33],[90,37,80,35],[91,8,81,6],[92,8,82,6],[92,12,82,10,"node"],[92,16,82,14],[92,17,82,15,"key"],[92,20,82,18],[92,24,82,22,"from"],[92,28,82,26],[92,30,82,28],[93,10,83,8],[94,10,84,8],[94,14,84,12],[94,15,84,13,"equalScalar"],[94,26,84,24],[94,27,84,25,"node"],[94,31,84,29],[94,32,84,30,"value"],[94,37,84,35],[94,39,84,37],[94,40,84,38],[94,41,84,39],[94,43,84,41],[95,12,85,10],[96,12,86,10,"callback"],[96,20,86,18],[96,21,86,19,"node"],[96,25,86,23],[96,26,86,24,"key"],[96,29,86,27],[96,31,86,29,"node"],[96,35,86,33],[96,36,86,34,"value"],[96,41,86,39],[96,43,86,41],[96,47,86,45],[96,48,86,46],[97,10,87,8],[98,8,88,6],[99,8,89,6],[100,8,90,6,"node"],[100,12,90,10],[100,15,90,13,"heap"],[100,19,90,17],[100,20,90,18,"extractMinimum"],[100,34,90,32],[100,35,90,33],[100,36,90,34],[101,8,91,6],[101,12,91,10,"node"],[101,16,91,14],[101,18,91,16],[102,10,92,8,"nodes"],[102,15,92,13],[102,16,92,14,"push"],[102,20,92,18],[102,21,92,19,"node"],[102,25,92,23],[102,26,92,24],[103,8,93,6],[104,6,94,4],[105,6,95,4],[106,6,96,4],[106,11,96,9],[106,15,96,13,"i"],[106,16,96,14],[106,19,96,17],[106,20,96,18],[106,22,96,20,"i"],[106,23,96,21],[106,26,96,24,"nodes"],[106,31,96,29],[106,32,96,30,"length"],[106,38,96,36],[106,40,96,38,"i"],[106,41,96,39],[106,43,96,41],[106,45,96,43],[107,8,97,6],[108,8,98,6],[108,12,98,10,"n"],[108,13,98,11],[108,16,98,14,"nodes"],[108,21,98,19],[108,22,98,20,"i"],[108,23,98,21],[108,24,98,22],[109,8,99,6],[110,8,100,6,"node"],[110,12,100,10],[110,15,100,13,"heap"],[110,19,100,17],[110,20,100,18,"insert"],[110,26,100,24],[110,27,100,25,"n"],[110,28,100,26],[110,29,100,27,"key"],[110,32,100,30],[110,34,100,32,"n"],[110,35,100,33],[110,36,100,34,"value"],[110,41,100,39],[110,42,100,40],[111,8,101,6],[112,8,102,6,"values"],[112,14,102,12],[112,15,102,13,"node"],[112,19,102,17],[112,20,102,18,"key"],[112,23,102,21],[112,24,102,22],[112,27,102,25,"node"],[112,31,102,29],[113,6,103,4],[114,4,104,2],[114,5,104,3],[115,4,105,2,"Spa"],[115,7,105,5],[115,8,105,6,"prototype"],[115,17,105,15],[115,18,105,16,"swap"],[115,22,105,20],[115,25,105,23],[115,35,105,33,"i"],[115,36,105,34],[115,38,105,36,"j"],[115,39,105,37],[115,41,105,39],[116,6,106,4],[117,6,107,4],[117,10,107,8,"nodei"],[117,15,107,13],[117,18,107,16],[117,22,107,20],[117,23,107,21,"_values"],[117,30,107,28],[117,31,107,29,"i"],[117,32,107,30],[117,33,107,31],[118,6,108,4],[118,10,108,8,"nodej"],[118,15,108,13],[118,18,108,16],[118,22,108,20],[118,23,108,21,"_values"],[118,30,108,28],[118,31,108,29,"j"],[118,32,108,30],[118,33,108,31],[119,6,109,4],[120,6,110,4],[120,10,110,8],[120,11,110,9,"nodei"],[120,16,110,14],[120,20,110,18,"nodej"],[120,25,110,23],[120,27,110,25],[121,8,111,6],[122,8,112,6,"nodei"],[122,13,112,11],[122,16,112,14],[122,20,112,18],[122,21,112,19,"_heap"],[122,26,112,24],[122,27,112,25,"insert"],[122,33,112,31],[122,34,112,32,"i"],[122,35,112,33],[122,37,112,35,"nodej"],[122,42,112,40],[122,43,112,41,"value"],[122,48,112,46],[122,49,112,47],[123,8,113,6],[124,8,114,6],[124,12,114,10],[124,13,114,11,"_heap"],[124,18,114,16],[124,19,114,17,"remove"],[124,25,114,23],[124,26,114,24,"nodej"],[124,31,114,29],[124,32,114,30],[125,8,115,6],[126,8,116,6],[126,12,116,10],[126,13,116,11,"_values"],[126,20,116,18],[126,21,116,19,"i"],[126,22,116,20],[126,23,116,21],[126,26,116,24,"nodei"],[126,31,116,29],[127,8,117,6],[127,12,117,10],[127,13,117,11,"_values"],[127,20,117,18],[127,21,117,19,"j"],[127,22,117,20],[127,23,117,21],[127,26,117,24,"undefined"],[127,35,117,33],[128,6,118,4],[128,7,118,5],[128,13,118,11],[128,17,118,15,"nodei"],[128,22,118,20],[128,26,118,24],[128,27,118,25,"nodej"],[128,32,118,30],[128,34,118,32],[129,8,119,6],[130,8,120,6,"nodej"],[130,13,120,11],[130,16,120,14],[130,20,120,18],[130,21,120,19,"_heap"],[130,26,120,24],[130,27,120,25,"insert"],[130,33,120,31],[130,34,120,32,"j"],[130,35,120,33],[130,37,120,35,"nodei"],[130,42,120,40],[130,43,120,41,"value"],[130,48,120,46],[130,49,120,47],[131,8,121,6],[132,8,122,6],[132,12,122,10],[132,13,122,11,"_heap"],[132,18,122,16],[132,19,122,17,"remove"],[132,25,122,23],[132,26,122,24,"nodei"],[132,31,122,29],[132,32,122,30],[133,8,123,6],[134,8,124,6],[134,12,124,10],[134,13,124,11,"_values"],[134,20,124,18],[134,21,124,19,"j"],[134,22,124,20],[134,23,124,21],[134,26,124,24,"nodej"],[134,31,124,29],[135,8,125,6],[135,12,125,10],[135,13,125,11,"_values"],[135,20,125,18],[135,21,125,19,"i"],[135,22,125,20],[135,23,125,21],[135,26,125,24,"undefined"],[135,35,125,33],[136,6,126,4],[136,7,126,5],[136,13,126,11],[136,17,126,15,"nodei"],[136,22,126,20],[136,26,126,24,"nodej"],[136,31,126,29],[136,33,126,31],[137,8,127,6],[138,8,128,6],[138,12,128,10,"v"],[138,13,128,11],[138,16,128,14,"nodei"],[138,21,128,19],[138,22,128,20,"value"],[138,27,128,25],[139,8,129,6,"nodei"],[139,13,129,11],[139,14,129,12,"value"],[139,19,129,17],[139,22,129,20,"nodej"],[139,27,129,25],[139,28,129,26,"value"],[139,33,129,31],[140,8,130,6,"nodej"],[140,13,130,11],[140,14,130,12,"value"],[140,19,130,17],[140,22,130,20,"v"],[140,23,130,21],[141,6,131,4],[142,4,132,2],[142,5,132,3],[143,4,133,2],[143,11,133,9,"Spa"],[143,14,133,12],[144,2,134,0],[144,3,134,1],[144,5,134,3],[145,4,135,2,"isClass"],[145,11,135,9],[145,13,135,11],[146,2,136,0],[146,3,136,1],[146,4,136,2],[147,0,136,3],[147,3]],"functionMap":{"names":["<global>","factory$argument_2","Spa","prototype.set","prototype.get","prototype.accumulate","prototype.forEach","prototype.swap"],"mappings":"AAA;uECG;ECU;GDQ;sBEc;GFW;sBGC;GHM;6BIC;GJY;0BKC;GLoC;uBMC;GN2B;CDE"},"hasCjsExports":false},"type":"js/module"}]}