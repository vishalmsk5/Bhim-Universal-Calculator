{"dependencies":[{"name":"./object.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":42,"index":42}}],"key":"c+4yuYP7E2Xh9QIfj2WEKgywjI4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.factory = factory;\n  exports.sortFactories = sortFactories;\n  exports.create = create;\n  exports.isFactory = isFactory;\n  exports.assertDependencies = assertDependencies;\n  exports.isOptionalDependency = isOptionalDependency;\n  exports.stripOptionalNotation = stripOptionalNotation;\n  var _objectJs = require(_dependencyMap[0], \"./object.js\");\n  /**\n   * Create a factory function, which can be used to inject dependencies.\n   *\n   * The created functions are memoized, a consecutive call of the factory\n   * with the exact same inputs will return the same function instance.\n   * The memoized cache is exposed on `factory.cache` and can be cleared\n   * if needed.\n   *\n   * Example:\n   *\n   *     const name = 'log'\n   *     const dependencies = ['config', 'typed', 'divideScalar', 'Complex']\n   *\n   *     export const createLog = factory(name, dependencies, ({ typed, config, divideScalar, Complex }) => {\n   *       // ... create the function log here and return it\n   *     }\n   *\n   * @param {string} name           Name of the function to be created\n   * @param {string[]} dependencies The names of all required dependencies\n   * @param {function} create       Callback function called with an object with all dependencies\n   * @param {Object} [meta]\n   *     Optional object with meta information that will be attached\n   *     to the created factory function as property `meta`. For explanation\n   *     of what meta properties can be specified and what they mean, see\n   *     docs/core/extension.md.\n   * @returns {function}\n   */\n  function factory(name, dependencies, create, meta) {\n    function assertAndCreate(scope) {\n      // we only pass the requested dependencies to the factory function\n      // to prevent functions to rely on dependencies that are not explicitly\n      // requested.\n      var deps = (0, _objectJs.pickShallow)(scope, dependencies.map(stripOptionalNotation));\n      assertDependencies(name, dependencies, scope);\n      return create(deps);\n    }\n    assertAndCreate.isFactory = true;\n    assertAndCreate.fn = name;\n    assertAndCreate.dependencies = dependencies.slice().sort();\n    if (meta) {\n      assertAndCreate.meta = meta;\n    }\n    return assertAndCreate;\n  }\n\n  /**\n   * Sort all factories such that when loading in order, the dependencies are resolved.\n   *\n   * @param {Array} factories\n   * @returns {Array} Returns a new array with the sorted factories.\n   */\n  function sortFactories(factories) {\n    var factoriesByName = {};\n    factories.forEach(factory => {\n      factoriesByName[factory.fn] = factory;\n    });\n    function containsDependency(factory, dependency) {\n      // TODO: detect circular references\n      if (isFactory(factory)) {\n        if (factory.dependencies.includes(dependency.fn || dependency.name)) {\n          return true;\n        }\n        if (factory.dependencies.some(d => containsDependency(factoriesByName[d], dependency))) {\n          return true;\n        }\n      }\n      return false;\n    }\n    var sorted = [];\n    function addFactory(factory) {\n      var index = 0;\n      while (index < sorted.length && !containsDependency(sorted[index], factory)) {\n        index++;\n      }\n      sorted.splice(index, 0, factory);\n    }\n\n    // sort regular factory functions\n    factories.filter(isFactory).forEach(addFactory);\n\n    // sort legacy factory functions AFTER the regular factory functions\n    factories.filter(factory => !isFactory(factory)).forEach(addFactory);\n    return sorted;\n  }\n\n  // TODO: comment or cleanup if unused in the end\n  function create(factories) {\n    var scope = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    sortFactories(factories).forEach(factory => factory(scope));\n    return scope;\n  }\n\n  /**\n   * Test whether an object is a factory. This is the case when it has\n   * properties name, dependencies, and a function create.\n   * @param {*} obj\n   * @returns {boolean}\n   */\n  function isFactory(obj) {\n    return typeof obj === 'function' && typeof obj.fn === 'string' && Array.isArray(obj.dependencies);\n  }\n\n  /**\n   * Assert that all dependencies of a list with dependencies are available in the provided scope.\n   *\n   * Will throw an exception when there are dependencies missing.\n   *\n   * @param {string} name   Name for the function to be created. Used to generate a useful error message\n   * @param {string[]} dependencies\n   * @param {Object} scope\n   */\n  function assertDependencies(name, dependencies, scope) {\n    var allDefined = dependencies.filter(dependency => !isOptionalDependency(dependency)) // filter optionals\n    .every(dependency => scope[dependency] !== undefined);\n    if (!allDefined) {\n      var missingDependencies = dependencies.filter(dependency => scope[dependency] === undefined);\n\n      // TODO: create a custom error class for this, a MathjsError or something like that\n      throw new Error(\"Cannot create function \\\"\".concat(name, \"\\\", \") + \"some dependencies are missing: \".concat(missingDependencies.map(d => \"\\\"\".concat(d, \"\\\"\")).join(', '), \".\"));\n    }\n  }\n  function isOptionalDependency(dependency) {\n    return dependency && dependency[0] === '?';\n  }\n  function stripOptionalNotation(dependency) {\n    return dependency && dependency[0] === '?' ? dependency.slice(1) : dependency;\n  }\n});","lineCount":142,"map":[[7,2,30,0,"exports"],[7,9,30,0],[7,10,30,0,"factory"],[7,17,30,0],[7,20,30,0,"factory"],[7,27,30,0],[8,2,54,0,"exports"],[8,9,54,0],[8,10,54,0,"sortFactories"],[8,23,54,0],[8,26,54,0,"sortFactories"],[8,39,54,0],[9,2,89,0,"exports"],[9,9,89,0],[9,10,89,0,"create"],[9,16,89,0],[9,19,89,0,"create"],[9,25,89,0],[10,2,101,0,"exports"],[10,9,101,0],[10,10,101,0,"isFactory"],[10,19,101,0],[10,22,101,0,"isFactory"],[10,31,101,0],[11,2,114,0,"exports"],[11,9,114,0],[11,10,114,0,"assertDependencies"],[11,28,114,0],[11,31,114,0,"assertDependencies"],[11,49,114,0],[12,2,124,0,"exports"],[12,9,124,0],[12,10,124,0,"isOptionalDependency"],[12,30,124,0],[12,33,124,0,"isOptionalDependency"],[12,53,124,0],[13,2,127,0,"exports"],[13,9,127,0],[13,10,127,0,"stripOptionalNotation"],[13,31,127,0],[13,34,127,0,"stripOptionalNotation"],[13,55,127,0],[14,2,1,0],[14,6,1,0,"_objectJs"],[14,15,1,0],[14,18,1,0,"require"],[14,25,1,0],[14,26,1,0,"_dependencyMap"],[14,40,1,0],[15,2,3,0],[16,0,4,0],[17,0,5,0],[18,0,6,0],[19,0,7,0],[20,0,8,0],[21,0,9,0],[22,0,10,0],[23,0,11,0],[24,0,12,0],[25,0,13,0],[26,0,14,0],[27,0,15,0],[28,0,16,0],[29,0,17,0],[30,0,18,0],[31,0,19,0],[32,0,20,0],[33,0,21,0],[34,0,22,0],[35,0,23,0],[36,0,24,0],[37,0,25,0],[38,0,26,0],[39,0,27,0],[40,0,28,0],[41,0,29,0],[42,2,30,7],[42,11,30,16,"factory"],[42,18,30,23,"factory"],[42,19,30,24,"name"],[42,23,30,28],[42,25,30,30,"dependencies"],[42,37,30,42],[42,39,30,44,"create"],[42,45,30,50],[42,47,30,52,"meta"],[42,51,30,56],[42,53,30,58],[43,4,31,2],[43,13,31,11,"assertAndCreate"],[43,28,31,26,"assertAndCreate"],[43,29,31,27,"scope"],[43,34,31,32],[43,36,31,34],[44,6,32,4],[45,6,33,4],[46,6,34,4],[47,6,35,4],[47,10,35,8,"deps"],[47,14,35,12],[47,17,35,15],[47,21,35,15,"pickShallow"],[47,30,35,26],[47,31,35,26,"pickShallow"],[47,42,35,26],[47,44,35,27,"scope"],[47,49,35,32],[47,51,35,34,"dependencies"],[47,63,35,46],[47,64,35,47,"map"],[47,67,35,50],[47,68,35,51,"stripOptionalNotation"],[47,89,35,72],[47,90,35,73],[47,91,35,74],[48,6,36,4,"assertDependencies"],[48,24,36,22],[48,25,36,23,"name"],[48,29,36,27],[48,31,36,29,"dependencies"],[48,43,36,41],[48,45,36,43,"scope"],[48,50,36,48],[48,51,36,49],[49,6,37,4],[49,13,37,11,"create"],[49,19,37,17],[49,20,37,18,"deps"],[49,24,37,22],[49,25,37,23],[50,4,38,2],[51,4,39,2,"assertAndCreate"],[51,19,39,17],[51,20,39,18,"isFactory"],[51,29,39,27],[51,32,39,30],[51,36,39,34],[52,4,40,2,"assertAndCreate"],[52,19,40,17],[52,20,40,18,"fn"],[52,22,40,20],[52,25,40,23,"name"],[52,29,40,27],[53,4,41,2,"assertAndCreate"],[53,19,41,17],[53,20,41,18,"dependencies"],[53,32,41,30],[53,35,41,33,"dependencies"],[53,47,41,45],[53,48,41,46,"slice"],[53,53,41,51],[53,54,41,52],[53,55,41,53],[53,56,41,54,"sort"],[53,60,41,58],[53,61,41,59],[53,62,41,60],[54,4,42,2],[54,8,42,6,"meta"],[54,12,42,10],[54,14,42,12],[55,6,43,4,"assertAndCreate"],[55,21,43,19],[55,22,43,20,"meta"],[55,26,43,24],[55,29,43,27,"meta"],[55,33,43,31],[56,4,44,2],[57,4,45,2],[57,11,45,9,"assertAndCreate"],[57,26,45,24],[58,2,46,0],[60,2,48,0],[61,0,49,0],[62,0,50,0],[63,0,51,0],[64,0,52,0],[65,0,53,0],[66,2,54,7],[66,11,54,16,"sortFactories"],[66,24,54,29,"sortFactories"],[66,25,54,30,"factories"],[66,34,54,39],[66,36,54,41],[67,4,55,2],[67,8,55,6,"factoriesByName"],[67,23,55,21],[67,26,55,24],[67,27,55,25],[67,28,55,26],[68,4,56,2,"factories"],[68,13,56,11],[68,14,56,12,"forEach"],[68,21,56,19],[68,22,56,20,"factory"],[68,29,56,27],[68,33,56,31],[69,6,57,4,"factoriesByName"],[69,21,57,19],[69,22,57,20,"factory"],[69,29,57,27],[69,30,57,28,"fn"],[69,32,57,30],[69,33,57,31],[69,36,57,34,"factory"],[69,43,57,41],[70,4,58,2],[70,5,58,3],[70,6,58,4],[71,4,59,2],[71,13,59,11,"containsDependency"],[71,31,59,29,"containsDependency"],[71,32,59,30,"factory"],[71,39,59,37],[71,41,59,39,"dependency"],[71,51,59,49],[71,53,59,51],[72,6,60,4],[73,6,61,4],[73,10,61,8,"isFactory"],[73,19,61,17],[73,20,61,18,"factory"],[73,27,61,25],[73,28,61,26],[73,30,61,28],[74,8,62,6],[74,12,62,10,"factory"],[74,19,62,17],[74,20,62,18,"dependencies"],[74,32,62,30],[74,33,62,31,"includes"],[74,41,62,39],[74,42,62,40,"dependency"],[74,52,62,50],[74,53,62,51,"fn"],[74,55,62,53],[74,59,62,57,"dependency"],[74,69,62,67],[74,70,62,68,"name"],[74,74,62,72],[74,75,62,73],[74,77,62,75],[75,10,63,8],[75,17,63,15],[75,21,63,19],[76,8,64,6],[77,8,65,6],[77,12,65,10,"factory"],[77,19,65,17],[77,20,65,18,"dependencies"],[77,32,65,30],[77,33,65,31,"some"],[77,37,65,35],[77,38,65,36,"d"],[77,39,65,37],[77,43,65,41,"containsDependency"],[77,61,65,59],[77,62,65,60,"factoriesByName"],[77,77,65,75],[77,78,65,76,"d"],[77,79,65,77],[77,80,65,78],[77,82,65,80,"dependency"],[77,92,65,90],[77,93,65,91],[77,94,65,92],[77,96,65,94],[78,10,66,8],[78,17,66,15],[78,21,66,19],[79,8,67,6],[80,6,68,4],[81,6,69,4],[81,13,69,11],[81,18,69,16],[82,4,70,2],[83,4,71,2],[83,8,71,6,"sorted"],[83,14,71,12],[83,17,71,15],[83,19,71,17],[84,4,72,2],[84,13,72,11,"addFactory"],[84,23,72,21,"addFactory"],[84,24,72,22,"factory"],[84,31,72,29],[84,33,72,31],[85,6,73,4],[85,10,73,8,"index"],[85,15,73,13],[85,18,73,16],[85,19,73,17],[86,6,74,4],[86,13,74,11,"index"],[86,18,74,16],[86,21,74,19,"sorted"],[86,27,74,25],[86,28,74,26,"length"],[86,34,74,32],[86,38,74,36],[86,39,74,37,"containsDependency"],[86,57,74,55],[86,58,74,56,"sorted"],[86,64,74,62],[86,65,74,63,"index"],[86,70,74,68],[86,71,74,69],[86,73,74,71,"factory"],[86,80,74,78],[86,81,74,79],[86,83,74,81],[87,8,75,6,"index"],[87,13,75,11],[87,15,75,13],[88,6,76,4],[89,6,77,4,"sorted"],[89,12,77,10],[89,13,77,11,"splice"],[89,19,77,17],[89,20,77,18,"index"],[89,25,77,23],[89,27,77,25],[89,28,77,26],[89,30,77,28,"factory"],[89,37,77,35],[89,38,77,36],[90,4,78,2],[92,4,80,2],[93,4,81,2,"factories"],[93,13,81,11],[93,14,81,12,"filter"],[93,20,81,18],[93,21,81,19,"isFactory"],[93,30,81,28],[93,31,81,29],[93,32,81,30,"forEach"],[93,39,81,37],[93,40,81,38,"addFactory"],[93,50,81,48],[93,51,81,49],[95,4,83,2],[96,4,84,2,"factories"],[96,13,84,11],[96,14,84,12,"filter"],[96,20,84,18],[96,21,84,19,"factory"],[96,28,84,26],[96,32,84,30],[96,33,84,31,"isFactory"],[96,42,84,40],[96,43,84,41,"factory"],[96,50,84,48],[96,51,84,49],[96,52,84,50],[96,53,84,51,"forEach"],[96,60,84,58],[96,61,84,59,"addFactory"],[96,71,84,69],[96,72,84,70],[97,4,85,2],[97,11,85,9,"sorted"],[97,17,85,15],[98,2,86,0],[100,2,88,0],[101,2,89,7],[101,11,89,16,"create"],[101,17,89,22,"create"],[101,18,89,23,"factories"],[101,27,89,32],[101,29,89,34],[102,4,90,2],[102,8,90,6,"scope"],[102,13,90,11],[102,16,90,14,"arguments"],[102,25,90,23],[102,26,90,24,"length"],[102,32,90,30],[102,35,90,33],[102,36,90,34],[102,40,90,38,"arguments"],[102,49,90,47],[102,50,90,48],[102,51,90,49],[102,52,90,50],[102,57,90,55,"undefined"],[102,66,90,64],[102,69,90,67,"arguments"],[102,78,90,76],[102,79,90,77],[102,80,90,78],[102,81,90,79],[102,84,90,82],[102,85,90,83],[102,86,90,84],[103,4,91,2,"sortFactories"],[103,17,91,15],[103,18,91,16,"factories"],[103,27,91,25],[103,28,91,26],[103,29,91,27,"forEach"],[103,36,91,34],[103,37,91,35,"factory"],[103,44,91,42],[103,48,91,46,"factory"],[103,55,91,53],[103,56,91,54,"scope"],[103,61,91,59],[103,62,91,60],[103,63,91,61],[104,4,92,2],[104,11,92,9,"scope"],[104,16,92,14],[105,2,93,0],[107,2,95,0],[108,0,96,0],[109,0,97,0],[110,0,98,0],[111,0,99,0],[112,0,100,0],[113,2,101,7],[113,11,101,16,"isFactory"],[113,20,101,25,"isFactory"],[113,21,101,26,"obj"],[113,24,101,29],[113,26,101,31],[114,4,102,2],[114,11,102,9],[114,18,102,16,"obj"],[114,21,102,19],[114,26,102,24],[114,36,102,34],[114,40,102,38],[114,47,102,45,"obj"],[114,50,102,48],[114,51,102,49,"fn"],[114,53,102,51],[114,58,102,56],[114,66,102,64],[114,70,102,68,"Array"],[114,75,102,73],[114,76,102,74,"isArray"],[114,83,102,81],[114,84,102,82,"obj"],[114,87,102,85],[114,88,102,86,"dependencies"],[114,100,102,98],[114,101,102,99],[115,2,103,0],[117,2,105,0],[118,0,106,0],[119,0,107,0],[120,0,108,0],[121,0,109,0],[122,0,110,0],[123,0,111,0],[124,0,112,0],[125,0,113,0],[126,2,114,7],[126,11,114,16,"assertDependencies"],[126,29,114,34,"assertDependencies"],[126,30,114,35,"name"],[126,34,114,39],[126,36,114,41,"dependencies"],[126,48,114,53],[126,50,114,55,"scope"],[126,55,114,60],[126,57,114,62],[127,4,115,2],[127,8,115,6,"allDefined"],[127,18,115,16],[127,21,115,19,"dependencies"],[127,33,115,31],[127,34,115,32,"filter"],[127,40,115,38],[127,41,115,39,"dependency"],[127,51,115,49],[127,55,115,53],[127,56,115,54,"isOptionalDependency"],[127,76,115,74],[127,77,115,75,"dependency"],[127,87,115,85],[127,88,115,86],[127,89,115,87],[127,90,115,88],[128,4,115,88],[128,5,116,3,"every"],[128,10,116,8],[128,11,116,9,"dependency"],[128,21,116,19],[128,25,116,23,"scope"],[128,30,116,28],[128,31,116,29,"dependency"],[128,41,116,39],[128,42,116,40],[128,47,116,45,"undefined"],[128,56,116,54],[128,57,116,55],[129,4,117,2],[129,8,117,6],[129,9,117,7,"allDefined"],[129,19,117,17],[129,21,117,19],[130,6,118,4],[130,10,118,8,"missingDependencies"],[130,29,118,27],[130,32,118,30,"dependencies"],[130,44,118,42],[130,45,118,43,"filter"],[130,51,118,49],[130,52,118,50,"dependency"],[130,62,118,60],[130,66,118,64,"scope"],[130,71,118,69],[130,72,118,70,"dependency"],[130,82,118,80],[130,83,118,81],[130,88,118,86,"undefined"],[130,97,118,95],[130,98,118,96],[132,6,120,4],[133,6,121,4],[133,12,121,10],[133,16,121,14,"Error"],[133,21,121,19],[133,22,121,20],[133,49,121,47],[133,50,121,48,"concat"],[133,56,121,54],[133,57,121,55,"name"],[133,61,121,59],[133,63,121,61],[133,69,121,67],[133,70,121,68],[133,73,121,71],[133,106,121,104],[133,107,121,105,"concat"],[133,113,121,111],[133,114,121,112,"missingDependencies"],[133,133,121,131],[133,134,121,132,"map"],[133,137,121,135],[133,138,121,136,"d"],[133,139,121,137],[133,143,121,141],[133,147,121,145],[133,148,121,146,"concat"],[133,154,121,152],[133,155,121,153,"d"],[133,156,121,154],[133,158,121,156],[133,162,121,160],[133,163,121,161],[133,164,121,162],[133,165,121,163,"join"],[133,169,121,167],[133,170,121,168],[133,174,121,172],[133,175,121,173],[133,177,121,175],[133,180,121,178],[133,181,121,179],[133,182,121,180],[134,4,122,2],[135,2,123,0],[136,2,124,7],[136,11,124,16,"isOptionalDependency"],[136,31,124,36,"isOptionalDependency"],[136,32,124,37,"dependency"],[136,42,124,47],[136,44,124,49],[137,4,125,2],[137,11,125,9,"dependency"],[137,21,125,19],[137,25,125,23,"dependency"],[137,35,125,33],[137,36,125,34],[137,37,125,35],[137,38,125,36],[137,43,125,41],[137,46,125,44],[138,2,126,0],[139,2,127,7],[139,11,127,16,"stripOptionalNotation"],[139,32,127,37,"stripOptionalNotation"],[139,33,127,38,"dependency"],[139,43,127,48],[139,45,127,50],[140,4,128,2],[140,11,128,9,"dependency"],[140,21,128,19],[140,25,128,23,"dependency"],[140,35,128,33],[140,36,128,34],[140,37,128,35],[140,38,128,36],[140,43,128,41],[140,46,128,44],[140,49,128,47,"dependency"],[140,59,128,57],[140,60,128,58,"slice"],[140,65,128,63],[140,66,128,64],[140,67,128,65],[140,68,128,66],[140,71,128,69,"dependency"],[140,81,128,79],[141,2,129,0],[142,0,129,1],[142,3]],"functionMap":{"names":["<global>","factory","assertAndCreate","sortFactories","factories.forEach$argument_0","containsDependency","dependencies.some$argument_0","addFactory","factories.filter$argument_0","create","sortFactories.forEach$argument_0","isFactory","assertDependencies","dependencies.filter$argument_0","dependencies.filter.every$argument_0","missingDependencies.map$argument_0","isOptionalDependency","stripOptionalNotation"],"mappings":"AAA;OC6B;ECC;GDO;CDQ;OGQ;oBCE;GDE;EEC;oCCM,uDD;GFK;EIE;GJM;mBKM,8BL;CHE;OSG;mCCE,yBD;CTE;OWQ;CXE;OYW;uCCC,+CD;SEC,6CF;kDCE,6CD;wIGG,yBH;CZE;OgBC;ChBE;OiBC"},"hasCjsExports":false},"type":"js/module"}]}