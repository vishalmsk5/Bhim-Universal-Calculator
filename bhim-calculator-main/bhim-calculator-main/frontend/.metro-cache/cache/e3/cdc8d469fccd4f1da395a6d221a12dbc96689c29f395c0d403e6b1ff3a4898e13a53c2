{"dependencies":[{"name":"../../utils/factory.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"7GBwrsWWKVeatBp94Er80/CdjPI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"createSpaClass\", {\n    enumerable: true,\n    get: function () {\n      return createSpaClass;\n    }\n  });\n  var _utilsFactoryJs = require(_dependencyMap[0], \"../../utils/factory.js\");\n  var name = 'Spa';\n  var dependencies = ['addScalar', 'equalScalar', 'FibonacciHeap'];\n  var createSpaClass = /* #__PURE__ */(0, _utilsFactoryJs.factory)(name, dependencies, _ref => {\n    var {\n      addScalar,\n      equalScalar,\n      FibonacciHeap\n    } = _ref;\n    /**\n     * An ordered Sparse Accumulator is a representation for a sparse vector that includes a dense array\n     * of the vector elements and an ordered list of non-zero elements.\n     */\n    function Spa() {\n      if (!(this instanceof Spa)) {\n        throw new SyntaxError('Constructor must be called with the new operator');\n      }\n\n      // allocate vector, TODO use typed arrays\n      this._values = [];\n      this._heap = new FibonacciHeap();\n    }\n\n    /**\n     * Attach type information\n     */\n    Spa.prototype.type = 'Spa';\n    Spa.prototype.isSpa = true;\n\n    /**\n     * Set the value for index i.\n     *\n     * @param {number} i                       The index\n     * @param {number | BigNumber | Complex}   The value at index i\n     */\n    Spa.prototype.set = function (i, v) {\n      // check we have a value @ i\n      if (!this._values[i]) {\n        // insert in heap\n        var node = this._heap.insert(i, v);\n        // set the value @ i\n        this._values[i] = node;\n      } else {\n        // update the value @ i\n        this._values[i].value = v;\n      }\n    };\n    Spa.prototype.get = function (i) {\n      var node = this._values[i];\n      if (node) {\n        return node.value;\n      }\n      return 0;\n    };\n    Spa.prototype.accumulate = function (i, v) {\n      // node @ i\n      var node = this._values[i];\n      if (!node) {\n        // insert in heap\n        node = this._heap.insert(i, v);\n        // initialize value\n        this._values[i] = node;\n      } else {\n        // accumulate value\n        node.value = addScalar(node.value, v);\n      }\n    };\n    Spa.prototype.forEach = function (from, to, callback) {\n      // references\n      var heap = this._heap;\n      var values = this._values;\n      // nodes\n      var nodes = [];\n      // node with minimum key, save it\n      var node = heap.extractMinimum();\n      if (node) {\n        nodes.push(node);\n      }\n      // extract nodes from heap (ordered)\n      while (node && node.key <= to) {\n        // check it is in range\n        if (node.key >= from) {\n          // check value is not zero\n          if (!equalScalar(node.value, 0)) {\n            // invoke callback\n            callback(node.key, node.value, this);\n          }\n        }\n        // extract next node, save it\n        node = heap.extractMinimum();\n        if (node) {\n          nodes.push(node);\n        }\n      }\n      // reinsert all nodes in heap\n      for (var i = 0; i < nodes.length; i++) {\n        // current node\n        var n = nodes[i];\n        // insert node in heap\n        node = heap.insert(n.key, n.value);\n        // update values\n        values[node.key] = node;\n      }\n    };\n    Spa.prototype.swap = function (i, j) {\n      // node @ i and j\n      var nodei = this._values[i];\n      var nodej = this._values[j];\n      // check we need to insert indeces\n      if (!nodei && nodej) {\n        // insert in heap\n        nodei = this._heap.insert(i, nodej.value);\n        // remove from heap\n        this._heap.remove(nodej);\n        // set values\n        this._values[i] = nodei;\n        this._values[j] = undefined;\n      } else if (nodei && !nodej) {\n        // insert in heap\n        nodej = this._heap.insert(j, nodei.value);\n        // remove from heap\n        this._heap.remove(nodei);\n        // set values\n        this._values[j] = nodej;\n        this._values[i] = undefined;\n      } else if (nodei && nodej) {\n        // swap values\n        var v = nodei.value;\n        nodei.value = nodej.value;\n        nodej.value = v;\n      }\n    };\n    return Spa;\n  }, {\n    isClass: true\n  });\n});","lineCount":149,"map":[[7,2,4,0,"Object"],[7,8,4,0],[7,9,4,0,"defineProperty"],[7,23,4,0],[7,24,4,0,"exports"],[7,31,4,0],[8,4,4,0,"enumerable"],[8,14,4,0],[9,4,4,0,"get"],[9,7,4,0],[9,18,4,0,"get"],[9,19,4,0],[10,6,4,0],[10,13,4,0,"createSpaClass"],[10,27,4,0],[11,4,4,0],[12,2,4,0],[13,2,1,0],[13,6,1,0,"_utilsFactoryJs"],[13,21,1,0],[13,24,1,0,"require"],[13,31,1,0],[13,32,1,0,"_dependencyMap"],[13,46,1,0],[14,2,2,0],[14,6,2,4,"name"],[14,10,2,8],[14,13,2,11],[14,18,2,16],[15,2,3,0],[15,6,3,4,"dependencies"],[15,18,3,16],[15,21,3,19],[15,22,3,20],[15,33,3,31],[15,35,3,33],[15,48,3,46],[15,50,3,48],[15,65,3,63],[15,66,3,64],[16,2,4,7],[16,6,4,11,"createSpaClass"],[16,20,4,25],[16,23,4,28],[16,38,4,43],[16,42,4,43,"factory"],[16,57,4,50],[16,58,4,50,"factory"],[16,65,4,50],[16,67,4,51,"name"],[16,71,4,55],[16,73,4,57,"dependencies"],[16,85,4,69],[16,87,4,71,"_ref"],[16,91,4,75],[16,95,4,79],[17,4,5,2],[17,8,5,6],[18,6,6,4,"addScalar"],[18,15,6,13],[19,6,7,4,"equalScalar"],[19,17,7,15],[20,6,8,4,"FibonacciHeap"],[21,4,9,2],[21,5,9,3],[21,8,9,6,"_ref"],[21,12,9,10],[22,4,10,2],[23,0,11,0],[24,0,12,0],[25,0,13,0],[26,4,14,2],[26,13,14,11,"Spa"],[26,16,14,14,"Spa"],[26,17,14,14],[26,19,14,17],[27,6,15,4],[27,10,15,8],[27,12,15,10],[27,16,15,14],[27,28,15,26,"Spa"],[27,31,15,29],[27,32,15,30],[27,34,15,32],[28,8,16,6],[28,14,16,12],[28,18,16,16,"SyntaxError"],[28,29,16,27],[28,30,16,28],[28,80,16,78],[28,81,16,79],[29,6,17,4],[31,6,19,4],[32,6,20,4],[32,10,20,8],[32,11,20,9,"_values"],[32,18,20,16],[32,21,20,19],[32,23,20,21],[33,6,21,4],[33,10,21,8],[33,11,21,9,"_heap"],[33,16,21,14],[33,19,21,17],[33,23,21,21,"FibonacciHeap"],[33,36,21,34],[33,37,21,35],[33,38,21,36],[34,4,22,2],[36,4,24,2],[37,0,25,0],[38,0,26,0],[39,4,27,2,"Spa"],[39,7,27,5],[39,8,27,6,"prototype"],[39,17,27,15],[39,18,27,16,"type"],[39,22,27,20],[39,25,27,23],[39,30,27,28],[40,4,28,2,"Spa"],[40,7,28,5],[40,8,28,6,"prototype"],[40,17,28,15],[40,18,28,16,"isSpa"],[40,23,28,21],[40,26,28,24],[40,30,28,28],[42,4,30,2],[43,0,31,0],[44,0,32,0],[45,0,33,0],[46,0,34,0],[47,0,35,0],[48,4,36,2,"Spa"],[48,7,36,5],[48,8,36,6,"prototype"],[48,17,36,15],[48,18,36,16,"set"],[48,21,36,19],[48,24,36,22],[48,34,36,32,"i"],[48,35,36,33],[48,37,36,35,"v"],[48,38,36,36],[48,40,36,38],[49,6,37,4],[50,6,38,4],[50,10,38,8],[50,11,38,9],[50,15,38,13],[50,16,38,14,"_values"],[50,23,38,21],[50,24,38,22,"i"],[50,25,38,23],[50,26,38,24],[50,28,38,26],[51,8,39,6],[52,8,40,6],[52,12,40,10,"node"],[52,16,40,14],[52,19,40,17],[52,23,40,21],[52,24,40,22,"_heap"],[52,29,40,27],[52,30,40,28,"insert"],[52,36,40,34],[52,37,40,35,"i"],[52,38,40,36],[52,40,40,38,"v"],[52,41,40,39],[52,42,40,40],[53,8,41,6],[54,8,42,6],[54,12,42,10],[54,13,42,11,"_values"],[54,20,42,18],[54,21,42,19,"i"],[54,22,42,20],[54,23,42,21],[54,26,42,24,"node"],[54,30,42,28],[55,6,43,4],[55,7,43,5],[55,13,43,11],[56,8,44,6],[57,8,45,6],[57,12,45,10],[57,13,45,11,"_values"],[57,20,45,18],[57,21,45,19,"i"],[57,22,45,20],[57,23,45,21],[57,24,45,22,"value"],[57,29,45,27],[57,32,45,30,"v"],[57,33,45,31],[58,6,46,4],[59,4,47,2],[59,5,47,3],[60,4,48,2,"Spa"],[60,7,48,5],[60,8,48,6,"prototype"],[60,17,48,15],[60,18,48,16,"get"],[60,21,48,19],[60,24,48,22],[60,34,48,32,"i"],[60,35,48,33],[60,37,48,35],[61,6,49,4],[61,10,49,8,"node"],[61,14,49,12],[61,17,49,15],[61,21,49,19],[61,22,49,20,"_values"],[61,29,49,27],[61,30,49,28,"i"],[61,31,49,29],[61,32,49,30],[62,6,50,4],[62,10,50,8,"node"],[62,14,50,12],[62,16,50,14],[63,8,51,6],[63,15,51,13,"node"],[63,19,51,17],[63,20,51,18,"value"],[63,25,51,23],[64,6,52,4],[65,6,53,4],[65,13,53,11],[65,14,53,12],[66,4,54,2],[66,5,54,3],[67,4,55,2,"Spa"],[67,7,55,5],[67,8,55,6,"prototype"],[67,17,55,15],[67,18,55,16,"accumulate"],[67,28,55,26],[67,31,55,29],[67,41,55,39,"i"],[67,42,55,40],[67,44,55,42,"v"],[67,45,55,43],[67,47,55,45],[68,6,56,4],[69,6,57,4],[69,10,57,8,"node"],[69,14,57,12],[69,17,57,15],[69,21,57,19],[69,22,57,20,"_values"],[69,29,57,27],[69,30,57,28,"i"],[69,31,57,29],[69,32,57,30],[70,6,58,4],[70,10,58,8],[70,11,58,9,"node"],[70,15,58,13],[70,17,58,15],[71,8,59,6],[72,8,60,6,"node"],[72,12,60,10],[72,15,60,13],[72,19,60,17],[72,20,60,18,"_heap"],[72,25,60,23],[72,26,60,24,"insert"],[72,32,60,30],[72,33,60,31,"i"],[72,34,60,32],[72,36,60,34,"v"],[72,37,60,35],[72,38,60,36],[73,8,61,6],[74,8,62,6],[74,12,62,10],[74,13,62,11,"_values"],[74,20,62,18],[74,21,62,19,"i"],[74,22,62,20],[74,23,62,21],[74,26,62,24,"node"],[74,30,62,28],[75,6,63,4],[75,7,63,5],[75,13,63,11],[76,8,64,6],[77,8,65,6,"node"],[77,12,65,10],[77,13,65,11,"value"],[77,18,65,16],[77,21,65,19,"addScalar"],[77,30,65,28],[77,31,65,29,"node"],[77,35,65,33],[77,36,65,34,"value"],[77,41,65,39],[77,43,65,41,"v"],[77,44,65,42],[77,45,65,43],[78,6,66,4],[79,4,67,2],[79,5,67,3],[80,4,68,2,"Spa"],[80,7,68,5],[80,8,68,6,"prototype"],[80,17,68,15],[80,18,68,16,"forEach"],[80,25,68,23],[80,28,68,26],[80,38,68,36,"from"],[80,42,68,40],[80,44,68,42,"to"],[80,46,68,44],[80,48,68,46,"callback"],[80,56,68,54],[80,58,68,56],[81,6,69,4],[82,6,70,4],[82,10,70,8,"heap"],[82,14,70,12],[82,17,70,15],[82,21,70,19],[82,22,70,20,"_heap"],[82,27,70,25],[83,6,71,4],[83,10,71,8,"values"],[83,16,71,14],[83,19,71,17],[83,23,71,21],[83,24,71,22,"_values"],[83,31,71,29],[84,6,72,4],[85,6,73,4],[85,10,73,8,"nodes"],[85,15,73,13],[85,18,73,16],[85,20,73,18],[86,6,74,4],[87,6,75,4],[87,10,75,8,"node"],[87,14,75,12],[87,17,75,15,"heap"],[87,21,75,19],[87,22,75,20,"extractMinimum"],[87,36,75,34],[87,37,75,35],[87,38,75,36],[88,6,76,4],[88,10,76,8,"node"],[88,14,76,12],[88,16,76,14],[89,8,77,6,"nodes"],[89,13,77,11],[89,14,77,12,"push"],[89,18,77,16],[89,19,77,17,"node"],[89,23,77,21],[89,24,77,22],[90,6,78,4],[91,6,79,4],[92,6,80,4],[92,13,80,11,"node"],[92,17,80,15],[92,21,80,19,"node"],[92,25,80,23],[92,26,80,24,"key"],[92,29,80,27],[92,33,80,31,"to"],[92,35,80,33],[92,37,80,35],[93,8,81,6],[94,8,82,6],[94,12,82,10,"node"],[94,16,82,14],[94,17,82,15,"key"],[94,20,82,18],[94,24,82,22,"from"],[94,28,82,26],[94,30,82,28],[95,10,83,8],[96,10,84,8],[96,14,84,12],[96,15,84,13,"equalScalar"],[96,26,84,24],[96,27,84,25,"node"],[96,31,84,29],[96,32,84,30,"value"],[96,37,84,35],[96,39,84,37],[96,40,84,38],[96,41,84,39],[96,43,84,41],[97,12,85,10],[98,12,86,10,"callback"],[98,20,86,18],[98,21,86,19,"node"],[98,25,86,23],[98,26,86,24,"key"],[98,29,86,27],[98,31,86,29,"node"],[98,35,86,33],[98,36,86,34,"value"],[98,41,86,39],[98,43,86,41],[98,47,86,45],[98,48,86,46],[99,10,87,8],[100,8,88,6],[101,8,89,6],[102,8,90,6,"node"],[102,12,90,10],[102,15,90,13,"heap"],[102,19,90,17],[102,20,90,18,"extractMinimum"],[102,34,90,32],[102,35,90,33],[102,36,90,34],[103,8,91,6],[103,12,91,10,"node"],[103,16,91,14],[103,18,91,16],[104,10,92,8,"nodes"],[104,15,92,13],[104,16,92,14,"push"],[104,20,92,18],[104,21,92,19,"node"],[104,25,92,23],[104,26,92,24],[105,8,93,6],[106,6,94,4],[107,6,95,4],[108,6,96,4],[108,11,96,9],[108,15,96,13,"i"],[108,16,96,14],[108,19,96,17],[108,20,96,18],[108,22,96,20,"i"],[108,23,96,21],[108,26,96,24,"nodes"],[108,31,96,29],[108,32,96,30,"length"],[108,38,96,36],[108,40,96,38,"i"],[108,41,96,39],[108,43,96,41],[108,45,96,43],[109,8,97,6],[110,8,98,6],[110,12,98,10,"n"],[110,13,98,11],[110,16,98,14,"nodes"],[110,21,98,19],[110,22,98,20,"i"],[110,23,98,21],[110,24,98,22],[111,8,99,6],[112,8,100,6,"node"],[112,12,100,10],[112,15,100,13,"heap"],[112,19,100,17],[112,20,100,18,"insert"],[112,26,100,24],[112,27,100,25,"n"],[112,28,100,26],[112,29,100,27,"key"],[112,32,100,30],[112,34,100,32,"n"],[112,35,100,33],[112,36,100,34,"value"],[112,41,100,39],[112,42,100,40],[113,8,101,6],[114,8,102,6,"values"],[114,14,102,12],[114,15,102,13,"node"],[114,19,102,17],[114,20,102,18,"key"],[114,23,102,21],[114,24,102,22],[114,27,102,25,"node"],[114,31,102,29],[115,6,103,4],[116,4,104,2],[116,5,104,3],[117,4,105,2,"Spa"],[117,7,105,5],[117,8,105,6,"prototype"],[117,17,105,15],[117,18,105,16,"swap"],[117,22,105,20],[117,25,105,23],[117,35,105,33,"i"],[117,36,105,34],[117,38,105,36,"j"],[117,39,105,37],[117,41,105,39],[118,6,106,4],[119,6,107,4],[119,10,107,8,"nodei"],[119,15,107,13],[119,18,107,16],[119,22,107,20],[119,23,107,21,"_values"],[119,30,107,28],[119,31,107,29,"i"],[119,32,107,30],[119,33,107,31],[120,6,108,4],[120,10,108,8,"nodej"],[120,15,108,13],[120,18,108,16],[120,22,108,20],[120,23,108,21,"_values"],[120,30,108,28],[120,31,108,29,"j"],[120,32,108,30],[120,33,108,31],[121,6,109,4],[122,6,110,4],[122,10,110,8],[122,11,110,9,"nodei"],[122,16,110,14],[122,20,110,18,"nodej"],[122,25,110,23],[122,27,110,25],[123,8,111,6],[124,8,112,6,"nodei"],[124,13,112,11],[124,16,112,14],[124,20,112,18],[124,21,112,19,"_heap"],[124,26,112,24],[124,27,112,25,"insert"],[124,33,112,31],[124,34,112,32,"i"],[124,35,112,33],[124,37,112,35,"nodej"],[124,42,112,40],[124,43,112,41,"value"],[124,48,112,46],[124,49,112,47],[125,8,113,6],[126,8,114,6],[126,12,114,10],[126,13,114,11,"_heap"],[126,18,114,16],[126,19,114,17,"remove"],[126,25,114,23],[126,26,114,24,"nodej"],[126,31,114,29],[126,32,114,30],[127,8,115,6],[128,8,116,6],[128,12,116,10],[128,13,116,11,"_values"],[128,20,116,18],[128,21,116,19,"i"],[128,22,116,20],[128,23,116,21],[128,26,116,24,"nodei"],[128,31,116,29],[129,8,117,6],[129,12,117,10],[129,13,117,11,"_values"],[129,20,117,18],[129,21,117,19,"j"],[129,22,117,20],[129,23,117,21],[129,26,117,24,"undefined"],[129,35,117,33],[130,6,118,4],[130,7,118,5],[130,13,118,11],[130,17,118,15,"nodei"],[130,22,118,20],[130,26,118,24],[130,27,118,25,"nodej"],[130,32,118,30],[130,34,118,32],[131,8,119,6],[132,8,120,6,"nodej"],[132,13,120,11],[132,16,120,14],[132,20,120,18],[132,21,120,19,"_heap"],[132,26,120,24],[132,27,120,25,"insert"],[132,33,120,31],[132,34,120,32,"j"],[132,35,120,33],[132,37,120,35,"nodei"],[132,42,120,40],[132,43,120,41,"value"],[132,48,120,46],[132,49,120,47],[133,8,121,6],[134,8,122,6],[134,12,122,10],[134,13,122,11,"_heap"],[134,18,122,16],[134,19,122,17,"remove"],[134,25,122,23],[134,26,122,24,"nodei"],[134,31,122,29],[134,32,122,30],[135,8,123,6],[136,8,124,6],[136,12,124,10],[136,13,124,11,"_values"],[136,20,124,18],[136,21,124,19,"j"],[136,22,124,20],[136,23,124,21],[136,26,124,24,"nodej"],[136,31,124,29],[137,8,125,6],[137,12,125,10],[137,13,125,11,"_values"],[137,20,125,18],[137,21,125,19,"i"],[137,22,125,20],[137,23,125,21],[137,26,125,24,"undefined"],[137,35,125,33],[138,6,126,4],[138,7,126,5],[138,13,126,11],[138,17,126,15,"nodei"],[138,22,126,20],[138,26,126,24,"nodej"],[138,31,126,29],[138,33,126,31],[139,8,127,6],[140,8,128,6],[140,12,128,10,"v"],[140,13,128,11],[140,16,128,14,"nodei"],[140,21,128,19],[140,22,128,20,"value"],[140,27,128,25],[141,8,129,6,"nodei"],[141,13,129,11],[141,14,129,12,"value"],[141,19,129,17],[141,22,129,20,"nodej"],[141,27,129,25],[141,28,129,26,"value"],[141,33,129,31],[142,8,130,6,"nodej"],[142,13,130,11],[142,14,130,12,"value"],[142,19,130,17],[142,22,130,20,"v"],[142,23,130,21],[143,6,131,4],[144,4,132,2],[144,5,132,3],[145,4,133,2],[145,11,133,9,"Spa"],[145,14,133,12],[146,2,134,0],[146,3,134,1],[146,5,134,3],[147,4,135,2,"isClass"],[147,11,135,9],[147,13,135,11],[148,2,136,0],[148,3,136,1],[148,4,136,2],[149,0,136,3],[149,3]],"functionMap":{"names":["<global>","factory$argument_2","Spa","prototype.set","prototype.get","prototype.accumulate","prototype.forEach","prototype.swap"],"mappings":"AAA;uECG;ECU;GDQ;sBEc;GFW;sBGC;GHM;6BIC;GJY;0BKC;GLoC;uBMC;GN2B;CDE"},"hasCjsExports":false},"type":"js/module"}]}